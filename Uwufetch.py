"""
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆ
â–ˆâ–‘â–‘â–„â–€â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–„â–€â–„â–€â–„â–€â–‘â–‘â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–„â–€â–‘â–‘â–ˆ
â–ˆâ–‘â–‘â–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–‘â–‘â–„â–€â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–‘â–‘â–ˆ
â–ˆâ–ˆâ–ˆâ–‘â–‘â–„â–€â–„â–€â–‘â–‘â–„â–€â–„â–€â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–ˆ
â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–„â–€â–„â–€â–„â–€â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–‘â–‘â–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–ˆ
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–„â–€â–„â–€â–„â–€â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–„â–€â–„â–€â–„â–€â–„â–€â–‘â–‘â–ˆâ–ˆâ–ˆ
â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–„â–€â–„â–€â–„â–€â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–‘â–‘â–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–ˆ
â–ˆâ–ˆâ–ˆâ–‘â–‘â–„â–€â–„â–€â–‘â–‘â–„â–€â–„â–€â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–ˆ
â–ˆâ–‘â–‘â–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–‘â–‘â–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–‘â–‘â–„â–€â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–‘â–‘â–‘â–‘â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–‘â–‘â–‘â–‘â–ˆ
â–ˆâ–‘â–‘â–„â–€â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–„â–€â–„â–€â–„â–€â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–„â–€â–„â–€â–„â–€â–‘â–‘â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–„â–€â–„â–€â–„â–€â–„â–€â–‘â–‘â–ˆâ–‘â–‘â–„â–€â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–„â–€â–„â–€â–‘â–‘â–ˆ
â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆ
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
"""
# meta developer: @xuduk

from .. import loader, utils
import subprocess
import traceback
import shutil

@loader.tds
class UwufetchMod(loader.Module):
    """ĞœĞ¾Ğ´ÑƒĞ»ÑŒ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° Uwufetch."""
    strings = {
        "name": "Uwufetch"
    }

    @loader.command()
    async def uwufetchcmd(self, message):
        """- Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ uwufetch"""
        message = await utils.answer(message, "<emoji document_id=5352752036595116992>ğŸ’—</emoji>")
        try:
            result = subprocess.run(["uwufetch"], capture_output=True, text=True)
            
            clean_result = subprocess.run(
                ["sed", "-E", r's/\x1B\[[0-9;]*[mK]//g; s/\x1B\[[0-9;]*[A-Z]//g'],
                input=result.stdout, capture_output=True, text=True
            )

            output = clean_result.stdout
            await utils.answer(message, f"<pre>{output}</pre>")

        except FileNotFoundError:
            await utils.answer(message, f"<emoji document_id=5210952531676504517>âŒ</emoji> Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸ uwufetch Ñ‡ĞµÑ€ĞµĞ· <code>{self.get_prefix()}installuwufetch</code>")

    @loader.command()
    async def installuwufetchcmd(self, message):
        """- ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ uwufetch"""
        message = await utils.answer(message, "<emoji document_id=5326015457155620929>â³</emoji>")
        try:
            install = (
                "git clone https://github.com/TheDarkBug/uwufetch.git && "
                "cd uwufetch && "
                "make build && "
                "sudo make install"
            )

            process = subprocess.run(
                install, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True
            )

            if process.returncode == 0:
                await utils.answer(message, "<emoji document_id=5237699328843200968>âœ…</emoji> Uwufetch ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½")
            else:
                await utils.answer(message, f"<emoji document_id=5210952531676504517>âŒ</emoji> ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞµ Uwufetch\n<pre>{process.stderr}</pre>")

        except Exception as e:
            await utils.answer(message, f"<emoji document_id=5210952531676504517>âŒ</emoji> ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞµ Uwufetch\n<pre>{str(e)}</pre>")

    @loader.command()
    async def uninstalluwufetchcmd(self, message):
        """- ÑƒĞ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ uwufetch"""
        message = await utils.answer(message, "<emoji document_id=5326015457155620929>â³</emoji>")
        try:
            uninstall = (
                "cd uwufetch && "
                "sudo make uninstall "
            )

            process = subprocess.run(
                uninstall, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True
            )

            shutil.rmtree("uwufetch")

            if process.returncode == 0:
                await utils.answer(message, "<emoji document_id=5237699328843200968>âœ…</emoji> Uwufetch ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ ÑƒĞ´Ğ°Ğ»ĞµĞ½")
            else:
                await utils.answer(message, f"<emoji document_id=5210952531676504517>âŒ</emoji> ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğ¸ Uwufetch\n<pre>{process.stderr}</pre>")

        except Exception as e:
            await utils.answer(message, f"<emoji document_id=5210952531676504517>âŒ</emoji> ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğ¸ Uwufetch\n<pre>{str(e)}</pre>")

